<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nim — JeHathor</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Cinzel:wght@400;600&family=Raleway:wght@300;400&display=swap" rel="stylesheet" />
    <style>
        :root {
            --gold: #c9a84c;
            --gold-light: #f0d080;
            --dark: #0a0a0f;
            --panel: rgba(255,255,255,0.04);
            --border: rgba(201,168,76,0.25);
            --border-hover: rgba(201,168,76,0.7);
            --text: #d4cfc7;
            --text-dim: rgba(212,207,199,0.55);
            --blue: #4a9eff;
            --red: #e05555;
        }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Raleway', sans-serif;
            font-weight: 300;
            background: var(--dark);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            overflow-x: hidden;
        }

        /* Starfield */
        body::before {
            content: '';
            position: fixed; inset: 0;
            background-image:
                radial-gradient(1px 1px at 15% 20%, rgba(255,255,255,0.55) 0%, transparent 100%),
                radial-gradient(1px 1px at 40% 60%, rgba(255,255,255,0.35) 0%, transparent 100%),
                radial-gradient(1px 1px at 70% 10%, rgba(255,255,255,0.45) 0%, transparent 100%),
                radial-gradient(1px 1px at 85% 75%, rgba(255,255,255,0.3)  0%, transparent 100%),
                radial-gradient(1px 1px at 55% 40%, rgba(255,255,255,0.4)  0%, transparent 100%),
                radial-gradient(1px 1px at 25% 85%, rgba(255,255,255,0.5)  0%, transparent 100%),
                radial-gradient(1px 1px at 92% 35%, rgba(255,255,255,0.3)  0%, transparent 100%),
                radial-gradient(1px 1px at 10% 50%, rgba(255,255,255,0.4)  0%, transparent 100%),
                radial-gradient(1px 1px at 62% 88%, rgba(255,255,255,0.35) 0%, transparent 100%),
                radial-gradient(1px 1px at 33% 12%, rgba(255,255,255,0.5)  0%, transparent 100%);
            pointer-events: none; z-index: 0;
        }
        body::after {
            content: '';
            position: fixed; top: -20%; left: 50%; transform: translateX(-50%);
            width: 80vw; height: 60vh;
            background: radial-gradient(ellipse, rgba(201,168,76,0.055) 0%, transparent 70%);
            pointer-events: none; z-index: 0;
        }

        /* ── Container ── */
        .container {
            position: relative; z-index: 10;
            max-width: 680px; width: 100%;
            animation: fadeUp 0.8s ease both;
        }

        /* ── Header ── */
        .site-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        .logo-rule {
            display: flex; align-items: center; justify-content: center;
            gap: 1.2rem; margin-bottom: 0.5rem;
        }
        .logo-rule::before { content: ''; flex: 1; max-width: 160px; height: 1px; background: linear-gradient(to right, transparent, var(--gold)); }
        .logo-rule::after  { content: ''; flex: 1; max-width: 160px; height: 1px; background: linear-gradient(to left,  transparent, var(--gold)); }
        .diamond { width: 7px; height: 7px; background: var(--gold); transform: rotate(45deg); flex-shrink: 0; }

        h1 {
            font-family: 'Cinzel Decorative', serif;
            font-size: clamp(1.8rem, 5vw, 2.8rem);
            color: var(--gold-light);
            letter-spacing: 0.06em;
            text-shadow: 0 0 40px rgba(201,168,76,0.4), 0 2px 4px rgba(0,0,0,0.8);
        }
        .subtitle {
            font-family: 'Cinzel', serif;
            font-size: 0.7rem; letter-spacing: 0.3em;
            text-transform: uppercase; color: var(--gold); opacity: 0.6;
            margin-top: 0.4rem;
        }

        /* ── Score cards ── */
        .scores {
            display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .score-card {
            border: 1px solid var(--border); background: var(--panel);
            padding: 1.2rem; text-align: center;
        }
        .score-label {
            font-family: 'Cinzel', serif; font-size: 0.6rem;
            letter-spacing: 0.25em; text-transform: uppercase;
            color: var(--text-dim); margin-bottom: 0.4rem;
        }
        .score-value {
            font-family: 'Cinzel Decorative', serif; font-size: 2.4rem;
            line-height: 1;
        }
        .player-score { color: var(--blue); text-shadow: 0 0 20px rgba(74,158,255,0.4); }
        .bot-score    { color: var(--red);  text-shadow: 0 0 20px rgba(224,85,85,0.4);  }

        /* ── Stick arena ── */
        .sticks-container {
            border: 1px solid var(--border); background: rgba(0,0,0,0.4);
            padding: 2rem 1.5rem; margin-bottom: 1.2rem;
            min-height: 140px;
            display: flex; flex-wrap: wrap; gap: 8px;
            justify-content: center; align-items: center;
        }

        .stick {
            width: 7px; height: 72px;
            background: linear-gradient(to bottom, var(--gold-light), var(--gold), #7a5c1e);
            border-radius: 3px;
            box-shadow: 0 0 6px rgba(201,168,76,0.35);
            transition: opacity 0.3s;
        }

        /* ── Remaining count ── */
        .remaining {
            font-family: 'Cinzel', serif;
            font-size: 1rem; letter-spacing: 0.15em;
            color: var(--gold-light); text-align: center;
            margin-bottom: 1.5rem; opacity: 0.85;
        }

        /* ── Divider ── */
        .divider {
            display: flex; align-items: center; gap: 1rem;
            margin: 1.5rem 0; opacity: 0.35;
        }
        .divider::before, .divider::after { content: ''; flex: 1; height: 1px; background: var(--gold); }
        .divider span { font-size: 0.5rem; color: var(--gold); }

        /* ── Controls ── */
        .control-label {
            font-family: 'Cinzel', serif; font-size: 0.62rem;
            letter-spacing: 0.25em; text-transform: uppercase;
            color: var(--text-dim); display: block; margin-bottom: 0.7rem;
        }

        .button-group {
            display: flex; gap: 0.6rem; margin-bottom: 1rem;
        }

        .select-btn {
            flex: 1; padding: 0.85rem;
            font-family: 'Cinzel', serif; font-size: 1.1rem;
            color: var(--text-dim);
            border: 1px solid var(--border); background: var(--panel);
            cursor: pointer;
            transition: border-color 0.25s, color 0.25s, background 0.25s;
        }
        .select-btn:hover { border-color: var(--gold); color: var(--gold); }
        .select-btn.selected {
            border: 1px solid var(--gold); background: rgba(201,168,76,0.12);
            color: var(--gold-light);
        }

        /* ── Action buttons ── */
        .take-btn, .new-game-btn {
            width: 100%;
            font-family: 'Cinzel', serif; font-size: 0.78rem;
            letter-spacing: 0.2em; text-transform: uppercase;
            padding: 1rem; border: none; cursor: pointer;
            transition: opacity 0.25s, background 0.25s;
            margin-bottom: 0.8rem;
        }
        .take-btn {
            background: var(--gold); color: var(--dark);
            font-weight: 600;
        }
        .take-btn:hover:not(:disabled) { background: var(--gold-light); }
        .take-btn:disabled {
            background: rgba(201,168,76,0.2); color: var(--text-dim); cursor: not-allowed;
        }
        .new-game-btn {
            background: transparent; color: var(--gold);
            border: 1px solid var(--gold);
        }
        .new-game-btn:hover { background: rgba(201,168,76,0.1); }

        /* ── Settings ── */
        .settings {
            display: grid; grid-template-columns: 1fr 1fr; gap: 0.8rem;
            margin-bottom: 1.2rem;
        }
        .setting-label {
            font-family: 'Cinzel', serif; font-size: 0.58rem;
            letter-spacing: 0.22em; text-transform: uppercase;
            color: var(--text-dim); display: block; margin-bottom: 0.5rem;
        }
        select, input[type="text"] {
            width: 100%; padding: 0.65rem 0.8rem;
            background: var(--panel); color: var(--text);
            border: 1px solid var(--border); font-family: 'Raleway', sans-serif;
            font-size: 0.82rem; outline: none;
            transition: border-color 0.25s;
            appearance: none; -webkit-appearance: none;
        }
        select:focus, input[type="text"]:focus { border-color: var(--gold); }
        select option { background: #111118; }

        /* ── Log ── */
        .log-container {
            border: 1px solid var(--border); background: var(--panel);
            padding: 1rem;
        }
        .log-title {
            font-family: 'Cinzel', serif; font-size: 0.58rem;
            letter-spacing: 0.3em; text-transform: uppercase;
            color: var(--text-dim); margin-bottom: 0.6rem;
        }
        .log-scroll {
            max-height: 120px; overflow-y: auto;
        }
        .log-entry {
            font-size: 0.75rem; color: var(--text-dim);
            padding: 0.3rem 0;
            border-bottom: 1px solid rgba(201,168,76,0.08);
            line-height: 1.5;
        }
        .log-entry:last-child { border-bottom: none; }
        .log-entry.player { color: rgba(74,158,255,0.85); }
        .log-entry.bot    { color: rgba(224,85,85,0.85); }
        .log-entry.win    { color: var(--gold-light); font-family: 'Cinzel', serif; letter-spacing: 0.1em; }

        /* ── Hidden ── */
        .hidden { display: none !important; }

        /* ── Animations ── */
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to   { opacity: 1; transform: translateY(0); }
        }
        .stick-pop {
            animation: stickPop 0.3s ease both;
        }
        @keyframes stickPop {
            from { opacity: 0; transform: scaleY(0.4); }
            to   { opacity: 1; transform: scaleY(1); }
        }

        @media (max-width: 480px) {
            .settings { grid-template-columns: 1fr; }
            .scores { grid-template-columns: 1fr 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">

        <div class="site-header">
            <div class="logo-rule"><div class="diamond"></div><h1>Nim</h1><div class="diamond"></div></div>
            <p class="subtitle">Take the last stick to win</p>
        </div>

        <div class="scores">
            <div class="score-card">
                <div class="score-label" id="playerLabel">Human Player</div>
                <div class="score-value player-score" id="playerScore">0</div>
            </div>
            <div class="score-card">
                <div class="score-label">NimBot</div>
                <div class="score-value bot-score" id="botScore">0</div>
            </div>
        </div>

        <div class="sticks-container" id="sticksContainer"></div>
        <div class="remaining" id="remaining">20 sticks remaining</div>

        <span class="control-label">Take sticks (max <span id="maxLabel">3</span>):</span>
        <div class="button-group" id="buttonGroup"></div>

        <button class="take-btn" id="takeBtn">Take 1 stick</button>
        <button class="new-game-btn hidden" id="newGameBtn">◆ &nbsp; New Game &nbsp; ◆</button>

        <div class="divider"><span>◆</span></div>

        <div class="settings">
            <div>
                <label class="setting-label" for="difficulty">Difficulty</label>
                <select id="difficulty">
                    <option value="Easy">Easy</option>
                    <option value="Medium">Medium</option>
                    <option value="Hard" selected>Hard</option>
                    <option value="Expert">Expert</option>
                </select>
            </div>
            <div>
                <label class="setting-label" for="playerName">Player Name</label>
                <input type="text" id="playerName" value="Human Player">
            </div>
        </div>

        <div class="log-container">
            <div class="log-title">Game Log</div>
            <div class="log-scroll" id="gameLog">
                <div class="log-entry">No moves yet...</div>
            </div>
        </div>

    </div>

    <script>
        const game = {
            sticks: 20,
            maxTake: 3,
            playerScore: 0,
            botScore: 0,
            difficulty: 'Hard',
            playerName: 'Human Player',
            selectedAmount: 1,
            isGameOver: false,
            isFirstMove: true,
            logs: []
        };

        function renderSticks() {
            const container = document.getElementById('sticksContainer');
            container.innerHTML = '';
            for (let i = 0; i < game.sticks; i++) {
                const stick = document.createElement('div');
                stick.className = 'stick stick-pop';
                stick.style.animationDelay = `${i * 0.02}s`;
                container.appendChild(stick);
            }
        }

        function updateRemaining() {
            document.getElementById('remaining').textContent =
                `${game.sticks} stick${game.sticks !== 1 ? 's' : ''} remaining`;
        }

        function renderButtons() {
            const container = document.getElementById('buttonGroup');
            container.innerHTML = '';
            let max = Math.min(game.maxTake, game.sticks);
            if (game.isFirstMove && game.playerScore <= game.botScore) {
                max = Math.min(game.maxTake + 1, game.sticks);
            }
            document.getElementById('maxLabel').textContent = max;
            for (let i = 1; i <= max; i++) {
                const btn = document.createElement('button');
                btn.className = 'select-btn' + (i === game.selectedAmount ? ' selected' : '');
                btn.textContent = i;
                btn.onclick = () => selectAmount(i);
                container.appendChild(btn);
            }
        }

        function selectAmount(amount) {
            game.selectedAmount = amount;
            renderButtons();
            document.getElementById('takeBtn').textContent =
                `Take ${amount} stick${amount > 1 ? 's' : ''}`;
        }

        function addLog(message, type = '') {
            game.logs.push({ message, type });
            const logContainer = document.getElementById('gameLog');
            logContainer.innerHTML = game.logs.map(log =>
                `<div class="log-entry ${log.type}">${log.message}</div>`
            ).join('');
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function calculateOptimalMove(remainingSticks) {
            if (remainingSticks <= game.maxTake) return remainingSticks;
            const optimalTake = remainingSticks % (game.maxTake + 1);
            if (optimalTake === 0) return Math.floor(Math.random() * game.maxTake) + 1;
            return optimalTake;
        }

        function botMove(remainingSticks) {
            let amount;
            if (game.difficulty === 'Easy') {
                amount = Math.floor(Math.random() * game.maxTake) + 1;
            } else if (game.difficulty === 'Medium') {
                amount = Math.random() > 0.4
                    ? Math.floor(Math.random() * game.maxTake) + 1
                    : calculateOptimalMove(remainingSticks);
            } else if (game.difficulty === 'Hard') {
                let threshold = remainingSticks > 16 ? 0.5 : remainingSticks > 8 ? 0.7 : 0.9;
                amount = Math.random() > threshold
                    ? Math.floor(Math.random() * game.maxTake) + 1
                    : calculateOptimalMove(remainingSticks);
            } else {
                amount = calculateOptimalMove(remainingSticks);
            }
            return Math.min(amount, remainingSticks);
        }

        function playerTake() {
            if (game.isGameOver || game.sticks === 0) return;

            const taken = Math.min(game.selectedAmount, game.sticks);
            game.sticks -= taken;
            game.isFirstMove = false;

            addLog(`${game.playerName} took ${taken} stick${taken > 1 ? 's' : ''}`, 'player');
            renderSticks();
            updateRemaining();

            if (game.sticks === 0) {
                addLog(`${game.playerName} wins!`, 'win');
                game.playerScore++;
                document.getElementById('playerScore').textContent = game.playerScore;
                endGame();
                return;
            }

            renderButtons();
            document.getElementById('takeBtn').disabled = true;

            setTimeout(() => {
                const botAmount = botMove(game.sticks);
                game.sticks -= botAmount;

                addLog(`NimBot took ${botAmount} stick${botAmount > 1 ? 's' : ''}`, 'bot');
                renderSticks();
                updateRemaining();

                if (game.sticks === 0) {
                    addLog('NimBot wins!', 'win');
                    game.botScore++;
                    document.getElementById('botScore').textContent = game.botScore;
                    endGame();
                } else {
                    renderButtons();
                    document.getElementById('takeBtn').disabled = false;
                }
            }, 800);
        }

        function endGame() {
            game.isGameOver = true;
            document.getElementById('takeBtn').classList.add('hidden');
            document.getElementById('newGameBtn').classList.remove('hidden');
        }

        function newGame() {
            game.sticks = 20;
            game.isGameOver = false;
            game.isFirstMove = true;
            game.selectedAmount = 1;
            game.logs = [];

            document.getElementById('gameLog').innerHTML = '<div class="log-entry">No moves yet...</div>';
            document.getElementById('takeBtn').classList.remove('hidden');
            document.getElementById('newGameBtn').classList.add('hidden');
            document.getElementById('takeBtn').disabled = false;
            document.getElementById('takeBtn').textContent = 'Take 1 stick';

            renderSticks();
            updateRemaining();
            renderButtons();
        }

        document.getElementById('takeBtn').onclick = playerTake;
        document.getElementById('newGameBtn').onclick = newGame;
        document.getElementById('difficulty').onchange = e => { game.difficulty = e.target.value; };
        document.getElementById('playerName').oninput = e => {
            game.playerName = e.target.value;
            document.getElementById('playerLabel').textContent = e.target.value;
        };

        renderSticks();
        renderButtons();
    </script>
</body>
</html>
